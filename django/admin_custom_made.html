<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="不知道描述啥"><title>Django Admin样式定制 | Sing</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Django Admin样式定制</h1><a id="logo" href="/.">Sing</a><p class="description">笔记</p></div><div id="nav-menu"><a href="/."><i class="fa undefined"> 首页</i></a><a class="current" href="/django"><i class="fa undefined"> Django</i></a><a href="/html_css"><i class="fa undefined"> Html_css</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Django Admin样式定制</h1><div class="post-content"><h3 id="一、将model注册到后台"><a href="#一、将model注册到后台" class="headerlink" title="一、将model注册到后台"></a>一、将model注册到后台</h3><p>以  中的model为例。在我们的APP目录下修改<code>admin.py</code>文件：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> demo <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line">admin.site.register(models.Student)</span><br></pre></td></tr></table></figure>
<p>然后在我们的后台可以看到：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0001.png" alt=""><br>然后我们点开<code>Students</code>看到：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0002.png" alt=""><br>这个样子我们什么都看不到，怎么才能想系统默认的那样看到各个字段的情况呢（自己插入点任意数据）？</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> student <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">"刘备"</span>,<span class="string">"******"</span>,<span class="string">"liubei@163.com"</span>,<span class="string">"yes"</span>,<span class="string">"daye"</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">"狄仁杰"</span>,<span class="string">"******"</span>,<span class="string">"direnjie@163.com"</span>,<span class="string">"no"</span>,<span class="string">"sheshou"</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">"后裔"</span>,<span class="string">"******"</span>,<span class="string">"houyi@163.com"</span>,<span class="string">"yes"</span>,<span class="string">"sheshou"</span>),</span><br><span class="line">(<span class="number">4</span>,<span class="string">"貂蝉"</span>,<span class="string">"******"</span>,<span class="string">"diaochan@163.com"</span>,<span class="string">"no"</span>,<span class="string">"fashi"</span>),</span><br><span class="line">(<span class="number">5</span>,<span class="string">"妲己"</span>,<span class="string">"******"</span>,<span class="string">"daji@163.com"</span>,<span class="string">"yes"</span>,<span class="string">"fashi"</span>),</span><br><span class="line">(<span class="number">6</span>,<span class="string">"李元芳"</span>,<span class="string">"******"</span>,<span class="string">"liyuanfang@163.com"</span>,<span class="string">"no"</span>,<span class="string">"sheshou"</span>),</span><br><span class="line">(<span class="number">7</span>,<span class="string">"诸葛亮"</span>,<span class="string">"******"</span>,<span class="string">"zhugeliang@163.com"</span>,<span class="string">"yes"</span>,<span class="string">"fashi"</span>),</span><br><span class="line">(<span class="number">8</span>,<span class="string">"蔡文姬"</span>,<span class="string">"******"</span>,<span class="string">"caiwenji@163.com"</span>,<span class="string">"no"</span>,<span class="string">"fuzhu"</span>),</span><br><span class="line">(<span class="number">9</span>,<span class="string">"孙尚香"</span>,<span class="string">"******"</span>,<span class="string">"sunshangxiang@163.com"</span>,<span class="string">"yes"</span>,<span class="string">"sheshou"</span>),</span><br><span class="line">(<span class="number">10</span>,<span class="string">"小乔"</span>,<span class="string">"******"</span>,<span class="string">"xiaoqiao@163.com"</span>,<span class="string">"no"</span>,<span class="string">"fashi"</span>),</span><br><span class="line">(<span class="number">11</span>,<span class="string">"典韦"</span>,<span class="string">"******"</span>,<span class="string">"dianwei@163.com"</span>,<span class="string">"yes"</span>,<span class="string">"daye"</span>),</span><br><span class="line">(<span class="number">12</span>,<span class="string">"墨子"</span>,<span class="string">"******"</span>,<span class="string">"mozi@163.com"</span>,<span class="string">"no"</span>,<span class="string">"fashi"</span>),</span><br><span class="line">(<span class="number">13</span>,<span class="string">"张飞"</span>,<span class="string">"******"</span>,<span class="string">"zhangfei1@163.com"</span>,<span class="string">"yes"</span>,<span class="string">"fuzhu"</span>),</span><br><span class="line">(<span class="number">14</span>,<span class="string">"大乔"</span>,<span class="string">"******"</span>,<span class="string">"daqiao1@163.com"</span>,<span class="string">"no"</span>,<span class="string">"fuzhu"</span>),</span><br><span class="line">(<span class="number">15</span>,<span class="string">"老夫子"</span>,<span class="string">"******"</span>,<span class="string">"laofuzi1@163.com"</span>,<span class="string">"yes"</span>,<span class="string">"daye"</span>),</span><br><span class="line">(<span class="number">16</span>,<span class="string">"张良"</span>,<span class="string">"******"</span>,<span class="string">"zhangliang1@163.com"</span>,<span class="string">"yes"</span>,<span class="string">"fashi"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="二、自定义数据展示样式"><a href="#二、自定义数据展示样式" class="headerlink" title="二、自定义数据展示样式"></a>二、自定义数据展示样式</h3><p>在我们的APP目录下修改<code>admin.py</code>文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> demo <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = (<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'email'</span>,<span class="string">'role'</span>)</span><br><span class="line">    </span><br><span class="line">admin.site.register(models.Student,Student) <span class="comment"># 注意第二个参数就是上面定义的</span></span><br></pre></td></tr></table></figure>
<p>通过定义<code>list_display</code>来定制我们展示的内容：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0003.png" alt=""><br>可以看到我们指定的字段已经全部显示。</p>
<h3 id="三、添加搜索框"><a href="#三、添加搜索框" class="headerlink" title="三、添加搜索框"></a>三、添加搜索框</h3><p>同样的在<code>admin.py</code>文件中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> demo <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = (<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'email'</span>,<span class="string">'role'</span>)</span><br><span class="line">    search_fields = (<span class="string">'username'</span>,<span class="string">'role'</span>) <span class="comment"># 注意这里</span></span><br><span class="line">       </span><br><span class="line">admin.site.register(models.Student,Student)</span><br></pre></td></tr></table></figure>
<p>通过<code>search_fields</code>属性来指定搜索的字段条件，界面如下：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0004.png" alt=""><br>比如我们输入<code>role</code>字段的值<code>打野</code>，然后搜索：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0005.png" alt="">  </p>
<h3 id="四、添加过滤器"><a href="#四、添加过滤器" class="headerlink" title="四、添加过滤器"></a>四、添加过滤器</h3><p>同样的在<code>admin.py</code>文件中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> demo <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = (<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'email'</span>,<span class="string">'role'</span>)</span><br><span class="line">    search_fields = (<span class="string">'username'</span>,<span class="string">'role'</span>)</span><br><span class="line">    list_filter = (<span class="string">'role'</span>,) </span><br><span class="line">       </span><br><span class="line">admin.site.register(models.Student,Student)</span><br></pre></td></tr></table></figure>
<p>通过<code>list_filter</code>属性来添加过滤器，也可以添加多个字段来添加多个过滤器：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0006.png" alt=""><br>可以发现右侧增加了过滤器，且点击了<code>射手</code>显示的数据。</p>
<h3 id="五、设置每页显示的条数"><a href="#五、设置每页显示的条数" class="headerlink" title="五、设置每页显示的条数"></a>五、设置每页显示的条数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> demo <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = (<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'email'</span>,<span class="string">'role'</span>)</span><br><span class="line">    search_fields = (<span class="string">'username'</span>,<span class="string">'role'</span>)</span><br><span class="line">    list_filter = (<span class="string">'role'</span>,) </span><br><span class="line">    list_per_page = <span class="number">4</span> <span class="comment"># 设置每页显示的条数</span></span><br><span class="line">    </span><br><span class="line">admin.site.register(models.Student,Student)</span><br></pre></td></tr></table></figure>
<p>通过<code>list_per_page</code>设置每页显示4条数据（清空我们的所有条件和过滤器）：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0007.png" alt="">  </p>
<h3 id="六、编辑每行字段"><a href="#六、编辑每行字段" class="headerlink" title="六、编辑每行字段"></a>六、编辑每行字段</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> demo <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = (<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'email'</span>,<span class="string">'role'</span>)</span><br><span class="line">    search_fields = (<span class="string">'username'</span>,<span class="string">'role'</span>)</span><br><span class="line">    list_filter = (<span class="string">'role'</span>,) </span><br><span class="line">    list_per_page = <span class="number">4</span> <span class="comment"># 设置每页显示的条数</span></span><br><span class="line">    list_editable = (<span class="string">'email'</span>,)</span><br><span class="line">    </span><br><span class="line">admin.site.register(models.Student,Student)</span><br></pre></td></tr></table></figure>
<p>通过<code>list_editable</code>属性使得邮箱可编辑，可以直接保存：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0008.png" alt=""><br>我们通过修改邮箱，然后点击保存，会发现在顶部提示修改是否成功。</p>
<h3 id="七、排序"><a href="#七、排序" class="headerlink" title="七、排序"></a>七、排序</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> demo <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = (<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'email'</span>,<span class="string">'role'</span>,<span class="string">'have_color'</span>)</span><br><span class="line">    search_fields = (<span class="string">'username'</span>,<span class="string">'role'</span>)</span><br><span class="line">    list_filter = (<span class="string">'role'</span>,) </span><br><span class="line">    list_per_page = <span class="number">4</span> <span class="comment"># 设置每页显示的条数</span></span><br><span class="line">    list_editable = (<span class="string">'email'</span>,<span class="string">'role'</span>,)</span><br><span class="line">    ordering = (<span class="string">'id'</span>,)</span><br><span class="line">    </span><br><span class="line">admin.site.register(models.Student,Student)</span><br></pre></td></tr></table></figure>
<p>我们发现现在默认是倒序排列，可以通过<code>ordering</code>属性来实现排序：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0009.png" alt="">  </p>
<h3 id="八、给role字段添加选项"><a href="#八、给role字段添加选项" class="headerlink" title="八、给role字段添加选项"></a>八、给role字段添加选项</h3><p>在数据库表中role字段很明显是固定的几个值（打野、法师、射手、辅助），我们使用选择固定在来修改，在<code>models.py</code>中修改：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    id=models.AutoField(max_length=<span class="number">100</span>,primary_key=<span class="keyword">True</span>)</span><br><span class="line">    username=models.CharField(max_length=<span class="number">100</span>)</span><br><span class="line">    password=models.CharField(max_length=<span class="number">100</span>)</span><br><span class="line">    email=models.CharField(max_length=<span class="number">100</span>)</span><br><span class="line"> </span><br><span class="line">    role_choices=(</span><br><span class="line">        (<span class="string">'daye'</span>,<span class="string">'打野'</span>),</span><br><span class="line">        (<span class="string">'fashi'</span>,<span class="string">'法师'</span>),</span><br><span class="line">        (<span class="string">'sheshou'</span>,<span class="string">'射手'</span>),</span><br><span class="line">        (<span class="string">'fuzhu'</span>,<span class="string">'辅助'</span>),</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    role=models.CharField(choices=role_choices,max_length=<span class="number">100</span>,default=<span class="string">'daye'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">u'Student'</span></span><br></pre></td></tr></table></figure>
<p>使用<code>role_choices</code>来列举出所有值，然后修改<code>role</code>字段，也就是增加<code>choices=role_choices</code>和默认值，默认字段一定要加，不然同步数据库会出错，同步数据库：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Sing<span class="number">-2</span>:hello Sing$ python manage.py makemigrations  <span class="comment"># 还是这两个命令</span></span><br><span class="line">Migrations <span class="keyword">for</span> <span class="string">'demo'</span>:</span><br><span class="line">  <span class="number">0005</span>_auto_20171025_0410.py:</span><br><span class="line">    - Alter field role on student</span><br><span class="line">Sing<span class="number">-2</span>:hello Sing$ python manage.py migrate         <span class="comment"># 还是这两个命令</span></span><br><span class="line">Operations to perform:</span><br><span class="line">  Apply all migrations: admin, auth, sessions, contenttypes, demo</span><br><span class="line">Running migrations:</span><br><span class="line">  Rendering model states... DONE</span><br><span class="line">  Applying demo<span class="number">.0005</span>_auto_20171025_0410... OK</span><br></pre></td></tr></table></figure>
<p>然后运行服务器查看效果：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0010.png" alt=""></p>
<h3 id="九、Admin中添加Actions"><a href="#九、Admin中添加Actions" class="headerlink" title="九、Admin中添加Actions"></a>九、Admin中添加Actions</h3><p>首先在<code>models.py</code>添加一个字段<code>have</code>，代表是否拥有此英雄，值为<code>yes</code>和<code>no</code>，如果拥有，则显示<code>拥有</code>切绿色背景白色字，否则显示<code>未有</code>切红色背景黑色字：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入html</span></span><br><span class="line"><span class="keyword">from</span> django.utils.html <span class="keyword">import</span> format_html</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 Student 中定义方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">have_color</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.have==<span class="string">'yes'</span>:</span><br><span class="line">            format_td=format_html(<span class="string">'&lt;span style="padding:5px;background-color:green;color:white"&gt;拥有&lt;/span&gt;'</span>)</span><br><span class="line">        <span class="keyword">if</span> self.have==<span class="string">'no'</span>:</span><br><span class="line">            format_td=format_html(<span class="string">'&lt;span style="padding:5px;background-color:red;color:black"&gt;未有&lt;/span&gt;'</span>)</span><br><span class="line">        <span class="keyword">return</span> format_td      <span class="comment"># 将html样式传递给admin展示页面</span></span><br></pre></td></tr></table></figure>
<p>然后在<code>admin.py</code>中添加选择的方法：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_have</span><span class="params">(modelAdmin,request,queryset)</span>:</span> <span class="comment">#queryset是选中的对象的集合</span></span><br><span class="line">    queryset.update(have=<span class="string">'yes'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_no_have</span><span class="params">(modelAdmin,request,queryset)</span>:</span></span><br><span class="line">    queryset.update(have=<span class="string">'no'</span>)</span><br></pre></td></tr></table></figure>
<p>很好理解，执行的时候将修改<code>have</code>字段的值，然后在<code>Student</code>中注册<code>actions</code>：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = (<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'email'</span>,<span class="string">'role'</span>,<span class="string">'have_color'</span>)</span><br><span class="line">    search_fields = (<span class="string">'username'</span>,<span class="string">'role'</span>)</span><br><span class="line">    list_filter = (<span class="string">'role'</span>,) </span><br><span class="line">    list_per_page = <span class="number">4</span> <span class="comment"># 设置每页显示的条数</span></span><br><span class="line">    list_editable = (<span class="string">'email'</span>,<span class="string">'role'</span>,)</span><br><span class="line">    ordering = (<span class="string">'id'</span>,)</span><br><span class="line">    </span><br><span class="line">    actions = [make_have,make_no_have] <span class="comment"># 上面的那两个方法</span></span><br><span class="line">       </span><br><span class="line">admin.site.register(models.Student,Student)</span><br></pre></td></tr></table></figure>
<p>注意在<code>list_display</code>中添加<code>have_color</code>字段，对应model中的方法名，看效果：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0011.gif" alt=""></p>
<h3 id="十、以指定的名字显示列名"><a href="#十、以指定的名字显示列名" class="headerlink" title="十、以指定的名字显示列名"></a>十、以指定的名字显示列名</h3><p><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0012.png" alt=""><br>目前的显示方式是默认的，我们可以在<code>models.py</code>中通过<code>verbose_name</code>属性来指定显示名：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    id=models.AutoField(verbose_name=<span class="string">'id'</span>,max_length=<span class="number">100</span>,primary_key=<span class="keyword">True</span>)</span><br><span class="line">    username=models.CharField(verbose_name=<span class="string">'姓名'</span>,max_length=<span class="number">100</span>)</span><br><span class="line">    password=models.CharField(verbose_name=<span class="string">'密码'</span>,max_length=<span class="number">100</span>)</span><br><span class="line">    email=models.CharField(verbose_name=<span class="string">'邮箱'</span>,max_length=<span class="number">100</span>)</span><br><span class="line">    have=models.CharField(verbose_name=<span class="string">'是否拥有'</span>,max_length=<span class="number">100</span>)</span><br><span class="line"> </span><br><span class="line">    role_choices=(</span><br><span class="line">        (<span class="string">'daye'</span>,<span class="string">'打野'</span>),</span><br><span class="line">        (<span class="string">'fashi'</span>,<span class="string">'法师'</span>),</span><br><span class="line">        (<span class="string">'sheshou'</span>,<span class="string">'射手'</span>),</span><br><span class="line">        (<span class="string">'fuzhu'</span>,<span class="string">'辅助'</span>),</span><br><span class="line">    )</span><br><span class="line"> </span><br><span class="line">    role=models.CharField(verbose_name=<span class="string">'角色'</span>,choices=role_choices,max_length=<span class="number">100</span>,default=<span class="string">'daye'</span>)</span><br><span class="line">    ....</span><br></pre></td></tr></table></figure>
<p>而我们显示的<code>have_color</code>则需要通过<code>short_description</code>来指定别名：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">have_color.short_description=<span class="string">'have'</span></span><br></pre></td></tr></table></figure>
<p>而在我们的网页端选择<code>Action</code>的时候显示的也是英文，也可以用这种方法指定别名，我们的最终效果：<br><img src="http://oupjofqw3.bkt.clouddn.com/python_django_admin_custom_made_0013.png" alt=""><br>最终的<code>models.py</code>和<code>admin.py</code>代码：</p>
<h4 id="models-py"><a href="#models-py" class="headerlink" title="models.py"></a>models.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.utils.html <span class="keyword">import</span> format_html</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    id=models.AutoField(verbose_name=<span class="string">'id'</span>,max_length=<span class="number">100</span>,primary_key=<span class="keyword">True</span>)</span><br><span class="line">    username=models.CharField(verbose_name=<span class="string">'姓名'</span>,max_length=<span class="number">100</span>)</span><br><span class="line">    password=models.CharField(verbose_name=<span class="string">'密码'</span>,max_length=<span class="number">100</span>)</span><br><span class="line">    email=models.CharField(verbose_name=<span class="string">'邮箱'</span>,max_length=<span class="number">100</span>)</span><br><span class="line">    have=models.CharField(verbose_name=<span class="string">'是否拥有'</span>,max_length=<span class="number">100</span>)</span><br><span class="line"> </span><br><span class="line">    role_choices=(</span><br><span class="line">        (<span class="string">'daye'</span>,<span class="string">'打野'</span>),</span><br><span class="line">        (<span class="string">'fashi'</span>,<span class="string">'法师'</span>),</span><br><span class="line">        (<span class="string">'sheshou'</span>,<span class="string">'射手'</span>),</span><br><span class="line">        (<span class="string">'fuzhu'</span>,<span class="string">'辅助'</span>),</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    role=models.CharField(verbose_name=<span class="string">'角色'</span>,choices=role_choices,max_length=<span class="number">100</span>,default=<span class="string">'daye'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">u'Student'</span></span><br><span class="line">        verbose_name_plural=<span class="string">u'用户'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">have_color</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.have==<span class="string">'yes'</span>:</span><br><span class="line">            format_td=format_html(<span class="string">'&lt;span style="padding:5px;background-color:green;color:white"&gt;拥有&lt;/span&gt;'</span>)</span><br><span class="line">        <span class="keyword">if</span> self.have==<span class="string">'no'</span>:</span><br><span class="line">            format_td=format_html(<span class="string">'&lt;span style="padding:5px;background-color:red;color:black"&gt;未有&lt;/span&gt;'</span>)</span><br><span class="line">        <span class="keyword">return</span> format_td      <span class="comment"># 将html样式传递给admin展示页面</span></span><br><span class="line"></span><br><span class="line">    have_color.short_description=<span class="string">'是否拥有'</span>  <span class="comment"># admin展示时名称为have(一个别名)</span></span><br></pre></td></tr></table></figure>
<h4 id="admin-py"><a href="#admin-py" class="headerlink" title="admin.py"></a>admin.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> demo <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将指定集合改为拥有</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_have</span><span class="params">(modelAdmin,request,queryset)</span>:</span> <span class="comment">#queryset是选中的对象的集合</span></span><br><span class="line">    queryset.update(have=<span class="string">'yes'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将指定集合改为未有</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_no_have</span><span class="params">(modelAdmin,request,queryset)</span>:</span></span><br><span class="line">    queryset.update(have=<span class="string">'no'</span>)</span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    list_display = (<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'email'</span>,<span class="string">'role'</span>,<span class="string">'have_color'</span>) <span class="comment"># 显示的字段</span></span><br><span class="line">    search_fields = (<span class="string">'username'</span>,<span class="string">'role'</span>) <span class="comment"># 可以搜索的字段</span></span><br><span class="line">    list_filter = (<span class="string">'role'</span>,)  <span class="comment"># 过滤器的字段</span></span><br><span class="line">    list_per_page = <span class="number">4</span> <span class="comment"># 设置每页显示的条数</span></span><br><span class="line">    list_editable = (<span class="string">'email'</span>,<span class="string">'role'</span>,) <span class="comment"># 可编辑字段</span></span><br><span class="line">    ordering = (<span class="string">'id'</span>,) <span class="comment"># 排序</span></span><br><span class="line">    </span><br><span class="line">    actions = [make_have,make_no_have]</span><br><span class="line">    make_have.short_description=<span class="string">'拥有'</span>   <span class="comment"># 给action指定别名</span></span><br><span class="line">    make_no_have.short_description=<span class="string">'未有'</span> <span class="comment"># 给action指定别名</span></span><br><span class="line">    </span><br><span class="line">admin.site.register(models.Student,Student)  <span class="comment"># 注册</span></span><br></pre></td></tr></table></figure></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySql/">MySql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/教程/">教程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计模式/">设计模式</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/03/29/Python_crawler/">用 Python 编写一个简单的爬虫</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/19/Android_CountDownTimer/">CountDownTimer的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/05/Android_decompile/">Android 反编译</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/01/Android_dialog_shadow/">Android 使用Dialog时状态栏变黑的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/21/Python_Django_simple_server/">基于 Python 的简单服务</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/21/Android_about_image/">Android 图片相关操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/16/DesignPattern_01_Principle/">《设计模式》走向灵活软件之路--面向对象的六大原则</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/13/MySql-17_indexes/">MySql_17 MySQL中的索引</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/10/Android_Application_Analysis/">Application 全面解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/30/Android_Glide_Basice/">Glide基础入门</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn/">京ICP备17062560号</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>